<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CV ‚Äî –º–∞–∫–µ—Ç A4, 2 –∫–æ–ª–æ–Ω–∫–∏</title>
    <meta name="color-scheme" content="light dark">
    <style>
        :root{
            --paper:#fff;
            --ink:#111;
            --muted:#6b7280;
            --rule:#e5e7eb;
            --chip:#f3f4f6;
            --gap-mm:0mm;
            --left-mm:72mm;
            --pad-mm:0mm;
        }
        @media (prefers-color-scheme: dark){
            body{ background:#0b0d10; }
        }
        *{ box-sizing:border-box; }
        html,body{ height:100%; }
        body{
            margin:0;
            background:#f1f5f9;
            color:var(--ink);
            font:14px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
        }
        .listA4{
            width:210mm;
            min-height:297mm;
            margin:18mm auto;
            background:var(--paper);
            box-shadow:0 10px 30px rgba(0,0,0,.08);
            border-radius:4px;
            overflow:hidden;
            display:grid;
            padding:var(--pad-mm);
            grid-template-columns: var(--left-mm) 1fr;
            grid-template-rows: 1fr;
            grid-auto-rows: min-content;
            column-gap: var(--gap-mm);
        }
        .colum-left{
            display:flex;
            flex-direction:column;
            gap: calc(var(--gap-mm) * .6);
            min-width:0;
            background: #f3f3f3;
            border-right: 1px solid #ff1010;
            -webkit-print-color-adjust: exact;
        }
        .colum-right{
            display:flex;
            flex-direction:column;
            gap: calc(var(--gap-mm) * .6);
            min-width:0;
        }
        .colum-left > div {
            background: transparent;
            border: none;
            padding: 0;
            border-radius: 0;
            break-inside: avoid;
            page-break-inside: avoid;
        }
        .colum-right > div {
            border-radius: 8px;
            background: color-mix(in oklab, var(--paper) 96%, transparent);
            border: 1px solid var(--rule);
            padding: 10px 12px;
            break-inside: avoid;
            page-break-inside: avoid;
        }
        .block-photo {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 60mm;
            height: 60mm;
            margin: 0 auto;
            border-radius: 50%;
            overflow: hidden;
            background: #e0e0e0;
            box-shadow: none;
        }
        .block-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            display: block;
        }
        .block-contacts ul,
        .block-skills ul,
        .block-tools ul{
            margin:.4rem 0 0; padding-left:1.1rem;
        }
        .block-contacts,
        .block-skills,
        .block-tools {
            margin-left: 10mm;
        }
        .pillset{ list-style:none; padding:0; margin:.2rem 0 0; display:flex; flex-wrap:wrap; gap:6px; }
        .pillset li{
            background:var(--chip);
            border:1px solid var(--rule);
            border-radius:999px;
            padding:5px 8px;
            font-size:12px;
        }
        .block-name{ border:none; padding:0; }
        .block-name h1{ margin:0; font-size:28px; line-height:1.2; }
        .block-position{ border:none; padding:0; color:var(--muted); margin-top:2px; }
        .block-about-me p{ margin:.4rem 0 0; }
        .block-experience .job{ margin:.5rem 0 0; padding:.2rem 0 0; border-top:1px solid var(--rule); }
        .block-experience .job h3{ margin:.2rem 0; font-size:15px; }
        .meta{ color:var(--muted); font-size:12px; }
        @page{ size:A4; margin: 12mm; }
        @media print{
            html,body{ background:transparent; }
            .listA4{
                width:auto; min-height:auto; margin:0; box-shadow:none; border-radius:0;
                padding:0;
                display:grid;
                grid-template-columns: var(--left-mm) 1fr;
                column-gap: var(--gap-mm);
                padding: var(--pad-mm);
            }
            a[href^="http"]::after{ content:" (" attr(href) ")"; color:#777; font-size:10px; }
        }
        @media (max-width: 960px){
            .listA4{
                width:100%; margin:0; border-radius:0; box-shadow:none;
                grid-template-columns: 1fr;
                row-gap: var(--gap-mm);
            }
        }
    </style>
</head>
<body>
<div class="listA4">
    <div class="colum-left">
        <div class="block-photo">
            <img id="photo" src="img.png" alt="–§–æ—Ç–æ">
        </div>
        <div class="block-contacts">
            <h2>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
            <ul id="contacts"></ul>
        </div>
        <div class="block-skills">
            <h2>–ù–∞–≤—ã–∫–∏</h2>
            <ul id="skills" class="pill set"></ul>
        </div>
        <div class="block-tools">
            <h2>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
            <ul id="tools" class="pill set"></ul>
        </div>
    </div>
    <div class="colum-right">
        <div class="block-name">
            <h1 id="name">‚Äî</h1>
        </div>
        <div class="block-position" id="position">‚Äî</div>
        <div class="block-about-me">
            <h2>–û–±–æ –º–Ω–µ</h2>
            <p id="about">‚Äî</p>
        </div>
        <div class="block-experience">
            <h2>–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã</h2>
            <div id="experience"></div>
        </div>
        <div class="block-education">
            <h2>–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</h2>
            <div id="education"></div>
        </div>
    </div>
</div>

<script>
    async function loadCV(){
        try{
            const res = await fetch('data.json', {cache:'no-store'});
            const data = await res.json();
            populate(data);
        }catch(e){
            console.error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å data.json', e);
        }
    }

    function el(tag, attrs={}, children=[]){
        const node = document.createElement(tag);
        Object.entries(attrs).forEach(([k,v])=>{
            if(k==='text') node.textContent = v;
            else if(k==='html') node.innerHTML = v;
            else if(k==='class') node.className = v;
            else if(k==='href') node.setAttribute('href', v);
            else if(k==='src') node.setAttribute('src', v);
            else if(k==='target') node.setAttribute('target', v);
            else node.setAttribute(k,v);
        });
        children.forEach(ch => node.appendChild(ch));
        return node;
    }

    function populate(cv){
        document.getElementById('name').textContent = cv.personal?.name || '';
        document.getElementById('position').textContent = cv.personal?.position || '';
        document.getElementById('about').textContent = cv.personal?.about || '';
        const photo = document.getElementById('photo');
        if (cv.personal?.photo) photo.src = cv.personal.photo;

        const contacts = document.getElementById('contacts');
        contacts.innerHTML = '';
        if(cv.contacts?.email){
            contacts.appendChild(el('li', {}, [
                el('span', {text:'üìß '}), el('a', {href:`mailto:${cv.contacts.email}`, text: cv.contacts.email})
            ]));
        }
        if(cv.contacts?.phone){
            const telDigits = cv.contacts.phone.replace(/\s|-/g,'');
            contacts.appendChild(el('li', {}, [
                el('span', {text:'üì± '}), el('a', {href:`tel:${telDigits}`, text: cv.contacts.phone})
            ]));
        }
        if(cv.contacts?.location){
            contacts.appendChild(el('li', {text:`üìç ${cv.contacts.location}`}));
        }
        if(cv.contacts?.telegram){
            contacts.appendChild(el('li', {}, [
                el('span', {text:'üí¨ '}), el('a', {href:cv.contacts.telegram, text: cv.contacts.telegram.replace(/^https?:\/\//,''), target:'_blank'})
            ]));
        }

        function fillList(id, items){
            const ul = document.getElementById(id);
            ul.innerHTML = '';
            (items||[]).forEach(s => ul.appendChild(el('li', {text:s})));
        }
        fillList('skills', cv.skills);
        fillList('tools', cv.tools);

        const expWrap = document.getElementById('experience');
        expWrap.innerHTML='';
        (cv.experience||[]).forEach(job => {
            const jobDiv = el('div', {class:'job'}, [
                el('h3', {text:`${job.company} ‚Äî ${job.position}`}),
                el('div', {class:'meta', text:`${job.period}${job.location ? ', ' + job.location : ''}`})
            ]);
            if(Array.isArray(job.responsibilities) && job.responsibilities.length){
                const ul = el('ul');
                job.responsibilities.forEach(r => ul.appendChild(el('li', {text:r})));
                jobDiv.appendChild(ul);
            }
            expWrap.appendChild(jobDiv);
        });

        const eduWrap = document.getElementById('education');
        eduWrap.innerHTML='';
        (cv.education||[]).forEach(ed => {
            const p = el('p', {}, [
                el('strong', {text: ed.institution || ''}),
                el('br'),
                el('span', {class:'meta', text:`${ed.period || ''} ¬∑ ${ed.program || ''}`})
            ]);
            eduWrap.appendChild(p);
        });
    }

    document.addEventListener('DOMContentLoaded', loadCV);
</script>
</body>
</html>
